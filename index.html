<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>CiteFast â€“ APA 7 Citation Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet"/>
<style>
/* â”€â”€ Reset & Variables â”€â”€ */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg: #0f1117;
  --surface: #181c27;
  --surface2: #1e2333;
  --border: #2a3045;
  --accent: #4ade80;
  --accent2: #38bdf8;
  --text: #e8eaf0;
  --muted: #6b7a99;
  --danger: #f87171;
  --radius: 10px;
  --font: 'Sora', sans-serif;
  --mono: 'DM Mono', monospace;
}

body {
  font-family: var(--font);
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

/* â”€â”€ Header â”€â”€ */
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 18px 32px;
  border-bottom: 1px solid var(--border);
  background: var(--surface);
}

.logo {
  font-size: 1.3rem;
  font-weight: 700;
  letter-spacing: -0.5px;
  color: var(--text);
}

.logo span { color: var(--accent); }

.badge {
  background: rgba(74,222,128,0.12);
  color: var(--accent);
  font-size: 0.72rem;
  font-weight: 600;
  padding: 3px 9px;
  border-radius: 20px;
  border: 1px solid rgba(74,222,128,0.25);
  letter-spacing: 0.05em;
}

/* â”€â”€ Layout â”€â”€ */
.layout {
  display: flex;
  flex: 1;
  max-width: 1100px;
  margin: 0 auto;
  width: 100%;
  padding: 32px 20px;
  gap: 28px;
}

/* â”€â”€ Left panel â”€â”€ */
.left-panel {
  width: 220px;
  flex-shrink: 0;
}

.panel-label {
  font-size: 0.72rem;
  font-weight: 600;
  color: var(--muted);
  letter-spacing: 0.1em;
  text-transform: uppercase;
  margin-bottom: 10px;
  padding-left: 4px;
}

.source-list {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.source-list li button {
  width: 100%;
  text-align: left;
  background: none;
  border: none;
  padding: 9px 12px;
  border-radius: 8px;
  font-family: var(--font);
  font-size: 0.88rem;
  color: var(--muted);
  cursor: pointer;
  transition: all 0.15s;
  display: flex;
  align-items: center;
  gap: 9px;
}

.source-list li button:hover {
  background: var(--surface2);
  color: var(--text);
}

.source-list li button.active {
  background: rgba(74,222,128,0.1);
  color: var(--accent);
  font-weight: 600;
}

.source-list li button .icon { font-size: 1rem; }

/* â”€â”€ Main panel â”€â”€ */
.main-panel { flex: 1; min-width: 0; }

/* â”€â”€ Search bar â”€â”€ */
.search-wrap {
  display: flex;
  gap: 10px;
  margin-bottom: 24px;
}

.search-input {
  flex: 1;
  background: var(--surface);
  border: 1.5px solid var(--border);
  border-radius: var(--radius);
  padding: 12px 16px;
  font-family: var(--font);
  font-size: 0.95rem;
  color: var(--text);
  outline: none;
  transition: border-color 0.2s;
}

.search-input::placeholder { color: var(--muted); }
.search-input:focus { border-color: var(--accent2); }

.btn {
  padding: 12px 20px;
  border-radius: var(--radius);
  border: none;
  font-family: var(--font);
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s;
  white-space: nowrap;
}

.btn-primary {
  background: var(--accent);
  color: #0f1117;
}
.btn-primary:hover { background: #22c55e; }
.btn-primary:disabled { opacity: 0.5; cursor: not-allowed; }

.btn-ghost {
  background: var(--surface);
  color: var(--muted);
  border: 1.5px solid var(--border);
}
.btn-ghost:hover { color: var(--text); border-color: var(--muted); }

/* â”€â”€ Loader â”€â”€ */
.loader {
  display: none;
  align-items: center;
  gap: 10px;
  color: var(--muted);
  font-size: 0.88rem;
  margin-bottom: 16px;
}
.spinner {
  width: 16px; height: 16px;
  border: 2px solid var(--border);
  border-top-color: var(--accent2);
  border-radius: 50%;
  animation: spin 0.7s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* â”€â”€ Form card â”€â”€ */
.form-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 28px;
  margin-bottom: 20px;
}

.form-card h2 {
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 20px;
  color: var(--text);
  display: flex;
  align-items: center;
  gap: 8px;
}

.form-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

.form-group { display: flex; flex-direction: column; gap: 6px; }
.form-group.full { grid-column: 1 / -1; }

label {
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--muted);
  letter-spacing: 0.04em;
}

input[type="text"], input[type="number"], select, textarea {
  background: var(--surface2);
  border: 1.5px solid var(--border);
  border-radius: 8px;
  padding: 10px 13px;
  font-family: var(--font);
  font-size: 0.9rem;
  color: var(--text);
  outline: none;
  transition: border-color 0.2s;
  width: 100%;
}
input:focus, select:focus, textarea:focus { border-color: var(--accent2); }
input::placeholder, textarea::placeholder { color: var(--muted); }
select option { background: var(--surface2); }

.auto-filled {
  border-color: var(--accent) !important;
  background: rgba(74,222,128,0.05) !important;
}

/* â”€â”€ Generate btn row â”€â”€ */
.form-actions {
  display: flex;
  gap: 10px;
  margin-top: 20px;
  flex-wrap: wrap;
}

/* â”€â”€ Citation result â”€â”€ */
.result-card {
  display: none;
  background: var(--surface);
  border: 1px solid var(--accent);
  border-radius: 12px;
  padding: 24px 28px;
  margin-bottom: 20px;
  animation: slideIn 0.25s ease;
}

@keyframes slideIn {
  from { opacity: 0; transform: translateY(8px); }
  to   { opacity: 1; transform: translateY(0); }
}

.result-label {
  font-size: 0.72rem;
  font-weight: 600;
  color: var(--accent);
  letter-spacing: 0.1em;
  text-transform: uppercase;
  margin-bottom: 12px;
}

.citation-text {
  font-size: 0.97rem;
  line-height: 1.8;
  color: var(--text);
  padding-left: 2em;
  text-indent: -2em;
  margin-bottom: 16px;
}

.intext-wrap {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
  padding: 10px 14px;
  background: var(--surface2);
  border-radius: 8px;
}
.intext-label { font-size: 0.8rem; color: var(--muted); white-space: nowrap; }
.intext-value { font-family: var(--mono); font-size: 0.9rem; color: var(--accent2); }

.result-actions { display: flex; gap: 8px; flex-wrap: wrap; }

.btn-sm {
  padding: 7px 14px;
  font-size: 0.82rem;
  border-radius: 7px;
}

.btn-save {
  background: rgba(56,189,248,0.12);
  color: var(--accent2);
  border: 1px solid rgba(56,189,248,0.25);
}
.btn-save:hover { background: rgba(56,189,248,0.2); }

.btn-copy {
  background: var(--surface2);
  color: var(--muted);
  border: 1px solid var(--border);
}
.btn-copy:hover { color: var(--text); }

/* â”€â”€ Saved citations â”€â”€ */
.saved-section {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  overflow: hidden;
}

.saved-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 24px;
  border-bottom: 1px solid var(--border);
}

.saved-header h3 { font-size: 0.95rem; font-weight: 600; }

.saved-count {
  background: var(--surface2);
  color: var(--muted);
  font-size: 0.78rem;
  padding: 2px 9px;
  border-radius: 20px;
  font-family: var(--mono);
}

.saved-empty {
  padding: 32px 24px;
  text-align: center;
  color: var(--muted);
  font-size: 0.88rem;
}

.saved-list { list-style: none; }

.saved-item {
  padding: 14px 24px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: flex-start;
  gap: 12px;
  animation: slideIn 0.2s ease;
}
.saved-item:last-child { border-bottom: none; }

.saved-item-text {
  flex: 1;
  font-size: 0.88rem;
  line-height: 1.6;
  color: var(--text);
  padding-left: 1.5em;
  text-indent: -1.5em;
}

.saved-item-del {
  background: none;
  border: none;
  color: var(--muted);
  cursor: pointer;
  font-size: 1rem;
  padding: 2px 6px;
  border-radius: 5px;
  transition: all 0.15s;
  flex-shrink: 0;
}
.saved-item-del:hover { background: rgba(248,113,113,0.15); color: var(--danger); }

.copy-all-row {
  padding: 12px 24px;
  border-top: 1px solid var(--border);
  display: flex;
  justify-content: flex-end;
}

/* â”€â”€ Toast â”€â”€ */
.toast {
  position: fixed;
  bottom: 24px;
  right: 24px;
  background: var(--surface2);
  border: 1px solid var(--border);
  color: var(--text);
  padding: 10px 18px;
  border-radius: 8px;
  font-size: 0.88rem;
  transform: translateY(80px);
  opacity: 0;
  transition: all 0.25s ease;
  z-index: 1000;
}
.toast.show { transform: translateY(0); opacity: 1; }
.toast.green { border-color: var(--accent); color: var(--accent); }

/* â”€â”€ Responsive â”€â”€ */
@media (max-width: 700px) {
  .left-panel { display: none; }
  .form-grid { grid-template-columns: 1fr; }
  header { padding: 14px 18px; }
  .layout { padding: 20px 14px; }
}
</style>
</head>
<body>

<header>
  <div class="logo">Cite<span>Fast</span></div>
  <div class="badge">APA 7</div>
</header>

<div class="layout">

  <!-- Source type sidebar -->
  <aside class="left-panel">
    <div class="panel-label">Source Type</div>
    <ul class="source-list" id="sourceNav">
      <li><button class="active" data-type="website"><span class="icon">ğŸŒ</span> Website</button></li>
      <li><button data-type="book"><span class="icon">ğŸ“–</span> Book</button></li>
      <li><button data-type="journal"><span class="icon">ğŸ“„</span> Journal Article</button></li>
      <li><button data-type="newspaper"><span class="icon">ğŸ“°</span> Newspaper</button></li>
      <li><button data-type="youtube"><span class="icon">â–¶ï¸</span> YouTube Video</button></li>
    </ul>
  </aside>

  <!-- Main content -->
  <main class="main-panel">

    <!-- URL search bar -->
    <div class="search-wrap">
      <input class="search-input" id="urlInput" type="text"
        placeholder="Paste a URL to auto-fill fields (e.g. https://www.nytimes.com/...)"/>
      <button class="btn btn-primary" id="searchBtn" onclick="fetchMeta()">Auto-Fill</button>
    </div>

    <div class="loader" id="loader">
      <div class="spinner"></div>
      Fetching page infoâ€¦
    </div>

    <!-- Citation form -->
    <div class="form-card">
      <h2 id="formTitle">ğŸŒ Cite a Website</h2>

      <div class="form-grid" id="formGrid">
        <!-- Fields injected by JS -->
      </div>

      <div class="form-actions">
        <button class="btn btn-primary" onclick="generateCitation()">Generate Citation</button>
        <button class="btn btn-ghost" onclick="clearForm()">Clear</button>
      </div>
    </div>

    <!-- Result -->
    <div class="result-card" id="resultCard">
      <div class="result-label">ğŸ“‹ Reference List Entry</div>
      <div class="citation-text" id="citationOutput"></div>

      <div class="intext-wrap">
        <span class="intext-label">In-text:</span>
        <span class="intext-value" id="inTextOutput"></span>
      </div>

      <div class="result-actions">
        <button class="btn btn-sm btn-copy" onclick="copyRef()">Copy Reference</button>
        <button class="btn btn-sm btn-copy" onclick="copyInText()">Copy In-text</button>
        <button class="btn btn-sm btn-save" onclick="saveCitation()">+ Save to List</button>
      </div>
    </div>

    <!-- Saved citations -->
    <div class="saved-section" id="savedSection">
      <div class="saved-header">
        <h3>ğŸ“š Saved Citations</h3>
        <span class="saved-count" id="savedCount">0</span>
      </div>
      <div class="saved-empty" id="savedEmpty">No citations saved yet. Generate one and click "Save to List."</div>
      <ul class="saved-list" id="savedList"></ul>
      <div class="copy-all-row" id="copyAllRow" style="display:none">
        <button class="btn btn-sm btn-save" onclick="copyAll()">Copy All Citations</button>
      </div>
    </div>

  </main>
</div>

<div class="toast" id="toast"></div>

<script>
// â”€â”€ Source type field definitions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SOURCES = {
  website: {
    title: 'ğŸŒ Cite a Website',
    fields: [
      { id:'authors',    label:'Author(s)',         placeholder:'Jane Doe',                   span:'half' },
      { id:'year',       label:'Year',              placeholder:'2024',                        span:'half', type:'number' },
      { id:'month',      label:'Month',             placeholder:'March',                       span:'half' },
      { id:'day',        label:'Day',               placeholder:'15',                          span:'half', type:'number' },
      { id:'title',      label:'Page Title',        placeholder:'The article title',           span:'full' },
      { id:'siteName',   label:'Website Name',      placeholder:'The New York Times',          span:'half' },
      { id:'websiteUrl', label:'URL',               placeholder:'https://www.example.com/...', span:'full' },
    ]
  },
  book: {
    title: 'ğŸ“– Cite a Book',
    fields: [
      { id:'authors',   label:'Author(s)',     placeholder:'Jane Doe',              span:'half' },
      { id:'year',      label:'Year',          placeholder:'2024',                  span:'half', type:'number' },
      { id:'title',     label:'Book Title',    placeholder:'The Great Book',        span:'full' },
      { id:'edition',   label:'Edition',       placeholder:'2nd',                   span:'half' },
      { id:'publisher', label:'Publisher',     placeholder:'Penguin Books',         span:'half' },
      { id:'doi',       label:'DOI (optional)',placeholder:'10.1000/xyz123',        span:'full' },
    ]
  },
  journal: {
    title: 'ğŸ“„ Cite a Journal Article',
    fields: [
      { id:'authors',  label:'Author(s)',       placeholder:'Jane Doe; John Smith', span:'full' },
      { id:'year',     label:'Year',            placeholder:'2024',                 span:'half', type:'number' },
      { id:'title',    label:'Article Title',   placeholder:'The article title',    span:'full' },
      { id:'journal',  label:'Journal Name',    placeholder:'Nature',               span:'half' },
      { id:'volume',   label:'Volume',          placeholder:'12',                   span:'half', type:'number' },
      { id:'issue',    label:'Issue',           placeholder:'3',                    span:'half', type:'number' },
      { id:'pages',    label:'Pages',           placeholder:'45â€“67',                span:'half' },
      { id:'doi',      label:'DOI',             placeholder:'10.1000/xyz123',       span:'full' },
    ]
  },
  newspaper: {
    title: 'ğŸ“° Cite a Newspaper',
    fields: [
      { id:'authors',    label:'Author(s)',       placeholder:'Jane Doe',              span:'half' },
      { id:'year',       label:'Year',            placeholder:'2024',                  span:'half', type:'number' },
      { id:'month',      label:'Month',           placeholder:'March',                 span:'half' },
      { id:'day',        label:'Day',             placeholder:'15',                    span:'half', type:'number' },
      { id:'title',      label:'Article Title',   placeholder:'The headline',          span:'full' },
      { id:'journal',    label:'Newspaper Name',  placeholder:'The Washington Post',   span:'half' },
      { id:'websiteUrl', label:'URL (if online)', placeholder:'https://...',           span:'full' },
    ]
  },
  youtube: {
    title: 'â–¶ï¸ Cite a YouTube Video',
    fields: [
      { id:'authors',    label:'Channel / Author', placeholder:'Kurzgesagt',              span:'half' },
      { id:'year',       label:'Year',             placeholder:'2024',                    span:'half', type:'number' },
      { id:'month',      label:'Month',            placeholder:'January',                 span:'half' },
      { id:'day',        label:'Day',              placeholder:'5',                       span:'half', type:'number' },
      { id:'title',      label:'Video Title',      placeholder:'How the universe works',  span:'full' },
      { id:'websiteUrl', label:'YouTube URL',      placeholder:'https://youtu.be/...',    span:'full' },
    ]
  },
};

let currentType = 'website';
let savedCitations = [];

// â”€â”€ Render the form fields for the selected source type â”€â”€â”€â”€â”€â”€â”€
function renderForm(type) {
  currentType = type;
  const def = SOURCES[type];
  document.getElementById('formTitle').textContent = def.title;

  const grid = document.getElementById('formGrid');
  grid.innerHTML = '';

  def.fields.forEach(f => {
    const div = document.createElement('div');
    div.className = 'form-group' + (f.span === 'full' ? ' full' : '');

    const lbl = document.createElement('label');
    lbl.setAttribute('for', 'field_' + f.id);
    lbl.textContent = f.label;

    const inp = document.createElement('input');
    inp.type = f.type || 'text';
    inp.id = 'field_' + f.id;
    inp.name = f.id;
    inp.placeholder = f.placeholder;

    div.appendChild(lbl);
    div.appendChild(inp);
    grid.appendChild(div);
  });

  document.getElementById('resultCard').style.display = 'none';
}

// â”€â”€ Source nav clicks â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('sourceNav').addEventListener('click', (e) => {
  const btn = e.target.closest('button');
  if (!btn) return;
  document.querySelectorAll('#sourceNav button').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  renderForm(btn.dataset.type);
});

// â”€â”€ Get all form values â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getFormData() {
  const data = { sourceType: currentType };
  SOURCES[currentType].fields.forEach(f => {
    const el = document.getElementById('field_' + f.id);
    if (el) data[f.id] = el.value.trim();
  });
  return data;
}

// â”€â”€ Auto-fill fields (highlight in green) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function fillFields(meta) {
  const map = {
    title:      meta.title,
    authors:    meta.author,
    year:       meta.year,
    month:      meta.month,
    day:        meta.day,
    siteName:   meta.siteName,
    websiteUrl: meta.url,
  };
  Object.entries(map).forEach(([key, val]) => {
    const el = document.getElementById('field_' + key);
    if (el && val) {
      el.value = val;
      el.classList.add('auto-filled');
      setTimeout(() => el.classList.remove('auto-filled'), 3000);
    }
  });
}

// â”€â”€ Fetch metadata from URL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function fetchMeta() {
  const rawUrl = document.getElementById('urlInput').value.trim();
  if (!rawUrl) { toast('Paste a URL first', false); return; }

  const loader = document.getElementById('loader');
  const btn = document.getElementById('searchBtn');
  loader.style.display = 'flex';
  btn.disabled = true;

  try {
    const res = await fetch('/fetch-meta', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ url: rawUrl }),
    });
    const data = await res.json();
    if (data.ok) {
      fillFields(data.meta);
      toast('âœ“ Fields auto-filled!', true);
    } else {
      toast('Could not fetch page. Fill manually.', false);
    }
  } catch {
    toast('Network error. Fill manually.', false);
  } finally {
    loader.style.display = 'none';
    btn.disabled = false;
  }
}

// â”€â”€ Generate citation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function generateCitation() {
  const data = getFormData();
  if (!data.title) { toast('Title is required', false); return; }

  try {
    const res = await fetch('/generate', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data),
    });
    const result = await res.json();

    document.getElementById('citationOutput').innerHTML = result.reference;
    document.getElementById('inTextOutput').textContent = result.inText;
    const card = document.getElementById('resultCard');
    card.style.display = 'block';
    card.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  } catch {
    toast('Server error. Is server.js running?', false);
  }
}

// â”€â”€ Save citation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function saveCitation() {
  const text = document.getElementById('citationOutput').innerHTML;
  if (!text) return;
  savedCitations.push(text);
  renderSaved();
  toast('âœ“ Saved to list!', true);
}

function renderSaved() {
  const list  = document.getElementById('savedList');
  const empty = document.getElementById('savedEmpty');
  const count = document.getElementById('savedCount');
  const copyRow = document.getElementById('copyAllRow');

  count.textContent = savedCitations.length;
  if (savedCitations.length === 0) {
    empty.style.display = 'block';
    list.innerHTML = '';
    copyRow.style.display = 'none';
    return;
  }
  empty.style.display = 'none';
  copyRow.style.display = 'flex';
  list.innerHTML = '';

  savedCitations.forEach((c, i) => {
    const li = document.createElement('li');
    li.className = 'saved-item';

    const p = document.createElement('p');
    p.className = 'saved-item-text';
    p.innerHTML = c;

    const del = document.createElement('button');
    del.className = 'saved-item-del';
    del.textContent = 'âœ•';
    del.title = 'Remove';
    del.onclick = () => { savedCitations.splice(i, 1); renderSaved(); };

    li.appendChild(p);
    li.appendChild(del);
    list.appendChild(li);
  });
}

// â”€â”€ Copy helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function copyRef() {
  const text = document.getElementById('citationOutput').innerText;
  navigator.clipboard.writeText(text).then(() => toast('âœ“ Reference copied!', true));
}
function copyInText() {
  const text = document.getElementById('inTextOutput').textContent;
  navigator.clipboard.writeText(text).then(() => toast('âœ“ In-text copied!', true));
}
function copyAll() {
  const all = savedCitations.map(c => {
    const tmp = document.createElement('div');
    tmp.innerHTML = c;
    return tmp.innerText;
  }).join('\n\n');
  navigator.clipboard.writeText(all).then(() => toast(`âœ“ ${savedCitations.length} citations copied!`, true));
}

// â”€â”€ Clear form â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function clearForm() {
  document.querySelectorAll('#formGrid input').forEach(el => el.value = '');
  document.getElementById('urlInput').value = '';
  document.getElementById('resultCard').style.display = 'none';
}

// â”€â”€ Toast notification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toast(msg, success = true) {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.className = 'toast show' + (success ? ' green' : '');
  setTimeout(() => el.className = 'toast', 2500);
}

// â”€â”€ Allow Enter key on URL input â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('urlInput').addEventListener('keydown', e => {
  if (e.key === 'Enter') fetchMeta();
});

// â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
renderForm('website');
renderSaved();
</script>
</body>
</html>
